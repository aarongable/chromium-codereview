
<polymer-element name="cr-issue-patchsets" attributes="patchsets">
    <template>
        <style>
            :host { display: block; }

            .patchset {
                border-color: #375B9C;
                border-width: 1px 1px 0 1px;
                border-style: solid;
                background-color: #DFE7F8;
            }

            .patchset:last-child {
                border-width: 1px;
            }

            .patchset-header {
                padding: 0.5em 16px;
                display: flex;
                font-weight: bold;
            }

            .file-header {
                padding: 0.5em 16px;
                display: flex;
            }

            .file-name,
            .patchset-title {
                flex: 1;
            }

            .polymer-ui-collapsible-header {
                cursor: pointer;
                -webkit-user-select: none;
            }
        </style>
        <template if="{{ patchsets }}">           
            <polymer-ui-accordion multi selected="{{ [ patchsets.length - 1 ] }}">
                <template repeat="{{ patchset, i in patchsets }}">
                    <polymer-ui-collapsible class="patchset">
                        <div class="patchset-header polymer-ui-collapsible-header">
                            <div class="patchset-title">
                                Patch set {{ i + 1 }}
                                <template if="{{ patchset.message }}">
                                    {{ patchset.message }}
                                </template>
                            </div>
                            <div class="patchset-date">{{ patchset.created | formatDate }}</div>
                        </div>
                        <div class="files">
                            <template repeat="{{ file in patchset.files }}">
                                <div class="file">
                                    <div class="file-header">
                                        <div class="file-name">{{ file.name }}</div>
                                        <div class="file-delta">+{{ file.added }} lines, -{{ file.removed }} lines</div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </polymer-ui-collapsible>
            </template>
        </template>
    </template>
    <script>
        Polymer("cr-issue-patchsets", {
            patchsets: null,
            formatDate: function(date) {
                if (!date)
                    return "";
                return date.relative();
            },
        });
    </script>
</polymer-element>
