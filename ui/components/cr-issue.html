
<link rel="import" href="cr-issue-messages.html">
<link rel="import" href="cr-issue-meta.html">
<link rel="import" href="cr-issue-patchsets.html">
<link rel="import" href="cr-linkified-text.html">

<polymer-element name="cr-issue" attributes="issue">
    <template>
        <style>
            :host { display: block; }

            h1, h2 {
                margin: 0;
                padding: 0.5em 16px;
            }

            h1 {
                font-size: 1.5em;
            }

            h2 {
                font-size: 1.3em;
            }

            a:link {
                color: #284D8C;
                text-decoration: none;
            }

            a:hover {
                text-decoration: underline;
            }

            .issue-subject {
                padding: 0.5em 16px;
            }

            .issue-description {
                margin: 1em 16px;
                white-space: pre-wrap;
                font-family: Monaco, monospace;
                flex: 1;
            }

            .issue-details {
                display: flex;
            }

            .issue-sidebar {
                order: 2;
                flex-shrink: 0;
                max-width: 25em;
                padding: 1em 16px;
            }

            .issue-toolbar {
                padding: 0.5em 0;
                display: flex;
            }

            .issue-toolbar button {
                border: 1px solid #3079ed;;
                background-color: #4d90fe;
                background-image: -webkit-linear-gradient(top, #4d90fe, #4787ed);
                border-radius: 2px;
                padding: 0.25em 1em;
                font-size: 1em;
                box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
                line-height: 1.5em;
                color: white;
                font-weight: normal;
                flex: 1;
                white-space: nowrap;
                flex-shrink: 0;
                min-width: -webkit-min-content;
            }

            .issue-toolbar button:active,
            .issue-toolbar button:hover {
                border-color: #2f5bb7;
                background-color: #357ae8;
                background-image: -webkit-linear-gradient(top, #4d90fe, #357ae8);
            }

            .issue-toolbar button:active {
                box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.3);
            }

            cr-issue-patchsets,
            cr-issue-messages {
                padding: 0.5em 16px;
            }
        </style>
        <template if="{{ issue }}">
            <h1 class="issue-subject">
                Issue <a href="#/issue/{{ issue.id }}">{{ issue.id }}</a>: {{ issue.subject }} <template if="{{ issue.closed }}">(Closed)</template>
            </h1>

            <div class="issue-details">
                <div class="issue-sidebar">
                    <cr-issue-meta issue="{{ issue }}"></cr-issue-meta>
                    <div class="issue-toolbar">
                        <button on-click="{{ quickLgtm }}">Quick LGTM</button>
                        <button on-click="{{ quickLgtmAndCommit }}">Quck LGTM + CQ</button>
                    </div>
                </div>
                <div class="issue-description"><cr-linkified-text text="{{ issue.description }}"></cr-linkified-text></div>
            </div>

            <h2>Patchsets</h2>
            <cr-issue-patchsets patchsets="{{ issue.patchsets }}"></cr-issue-patchsets>

            <h2>Messages</h2>
            <cr-issue-messages messages="{{ issue.messages }}"></cr-issue-messages>
        </template>
    </template>
    <script>
        Polymer("cr-issue", {
            issue: null,
            quickLgtm: function() {
                this.fire("quick-lgtm");
            },
            quickLgtmAndCommit: function() {
                this.fire("quick-lgtm-and-commit");
            },
        });
    </script>
</polymer-element>
