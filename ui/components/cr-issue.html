
<link rel="import" href="cr-issue-messages.html">
<link rel="import" href="cr-issue-patchsets.html">

<polymer-element name="cr-issue" attributes="issue">
    <template>
        <style>
            :host { display: block; }

            h1, h2 {
                margin: 0;
                padding: 0.5em 16px;
            }

            h1 {
                font-size: 1.5em;
            }

            h2 {
                font-size: 1.3em;
            }

            .issue-subject {
                padding: 0.5em 16px;
            }

            .issue-description {
                white-space: pre-wrap;
                margin: 0;
                flex: 1;
            }

            .issue-description,
            .issue-meta {
                margin: 1em 16px;
            }

            .issue-details {
                display: flex;
            }

            .issue-meta {
                order: 2;
                flex-shrink: 0;
                border: 1px solid #CCC;
                display: table;
            }

            .issue-author,
            .issue-created,
            .issue-modified {
                display: table-row;
            }

            .issue-meta-type,
            .issue-meta-value {
                padding: 0.5em 16px;
                word-wrap: nowrap;
                display: table-cell;
            }

            .issue-meta-type {
                color: #959595;
                font-weight: bold;
            }

            cr-issue-patchsets,
            cr-issue-messages {
                padding: 0.5em 16px;
            }
        </style>
        <template if="{{ issue }}">
            <h1 class="issue-subject">
                Issue {{ issue.id }}: {{ issue.subject }} <template if="{{ issue.closed }}">(Closed)</template>
            </h1>

            <div class="issue-details">
                <div class="issue-meta">
                    <div class="issue-author">
                        <div class="issue-meta-type">Author</div>
                        <div class="issue-meta-value">{{ issue.owner.name }}</div>
                    </div>
                    <div class="issue-created">
                        <div class="issue-meta-type">Created</div>
                        <div class="issue-meta-value">{{ issue.created | formatDate }}</div>
                    </div>
                    <div class="issue-modified">
                        <div class="issue-meta-type">Modified</div>
                        <div class="issue-meta-value">{{ issue.lastModified | formatDate }}</div>
                    </div>
                </div>
                <div class="issue-description">{{ issue.description }}</div>
            </div>

            <h2>Patchsets</h2>
            <cr-issue-patchsets patchsets="{{ issue.patchsets }}"></cr-issue-patchsets>

            <h2>Messages</h2>
            <cr-issue-messages messages="{{ issue.messages }}"></cr-issue-messages>
        </template>
    </template>
    <script>
        Polymer("cr-issue", {
            issue: null,
            formatDate: function(date) {
                if (!date)
                    return "";
                return date.format("{Mon} {ord} {yyyy} {hh}:{mm}{tt}");
            },
        });
    </script>
</polymer-element>
